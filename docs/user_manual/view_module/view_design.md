## 1 基础功能

### 1.1 视图字段管理

!!! Abstract ""
    视图级别计算字段随视图，不影响数据集的计算字段。

    - 支持 Avg、Sum、Count、Min、Max 聚合函数；  
    - 新建的视图级别指标类字段，如果涉及到聚合函数，则不能单独出现该字段，必须是聚合函数和聚合函数的组合，比如可以 sum(salary)/count(user)，不能 salary/sum(salary)；  
    - 创建的字段若使用了聚合函数，则只能是指标，不能转维度。
    
    如下图所示，点击箭头指向的【齿轮】，选择【视图字段管理】，进入视图字段管理界面。

![编辑视图字段入口](../../img/view_generation/视图字段管理入口.png){ width="900px" }

![编辑视图字段界面](../../img/view_generation/编辑视图字段界面.png){ width="900px" }

!!! Abstract ""
    如下示例计算求和。

![编辑视图字段](../../img/view_generation/编辑视图字段.png){ width="900px" }

![编辑视图字段](../../img/view_generation/编辑视图字段展示.png){ width="900px" }

!!! Abstract ""
    如下示例计算求和后的占比。

![编辑视图字段_求和占比](../../img/view_generation/编辑视图字段_求和占比.png){ width="900px"}

![编辑视图字段_求和占比_展示结果](../../img/view_generation/编辑视图字段_求和占比_展示结果1.png){ width="900px" }

![编辑视图字段_求和占比_展示结果](../../img/view_generation/编辑视图字段_求和占比_展示结果2.png){ width="900px" }

### 1.2 数据集字段管理

!!! Abstract ""
    如下图所示，点击箭头指向的【齿轮】，选择【数据集字段管理】，可编辑对应数据集的字段，如修改字段类型、名称、切换为维度或指标等。

![编辑视图字段入口](../../img/view_generation/数据集字段管理入口.png){ width="900px" }

### 1.3 更换数据集

!!! Abstract ""
    如下图，点击箭头指向的位置，可为视图更换数据集，更换视图数据集时，系统会根据数据集字段名自动匹配（区分大小写），若字段名称、类型等无法匹配，则该字段会标红显示。  
    **提示：若更换后的数据集与原数据集字段发生变化，需重新制作视图，若更换后的数据集与原数据集字段可匹配上，视图数据自动根据更换后的数据集展示，不用再做调整。**

![更换数据集入口](../../img/view_generation/更换数据集入口.png){ width="900px" }

!!! Abstract ""
    更换数据集，右侧显示出原数据集的内容，选定更换的数据集，点击【确定】即可。

![更换数据集](../../img/view_generation/更换数据集.png){ width="900px" }

### 1.4 更改图表类型

!!! Abstract ""
    展示所有图表类型，如柱形图，折线图，组合图、雷达图等，可通过点击图标进行图表类型的切换。

![图表类型](../../img/view_generation/图表类型.png){ width="900px" }

### 1.5 视图下钻

!!! Abstract ""
    如下示例，生成全国的 GDP 地图后，拖拽钻取字段至【钻取/维度】；  
    字段下钻后将延续第一层排序规则（仅对升降序有效）；  
    **支持下钻区域文字跟随视图背景改变；**  
    **示例数据集如下，维度为地区，同一维度的地区由省、市、区/县三个不同层次（粒度）构成，示例数据集中可通过“省”钻取到“市”，从“市”下钻到“区/县”。**

| province | city | district | gdp     |
|----------|------|--------|---------|
| 广东省      | 深圳市  | 罗湖区    | 1149.53 |
| 广东省      | 深圳市  | 南山区    | 3042.29 |
| 广东省      | 深圳市  | 福田区    | 2225.76 |
| 广东省      | 广州市  | 天河区    | 6012.20 |
| 广东省      | 广州市  | 黄埔区    | 4158.37 |
| 广东省      | 广州市  | 越秀区    | 3629.48 |
| 浙江省      | 杭州市  | 余杭区    | 1195.4  |
| 浙江省      | 杭州市  | 上城区    | 1183.2  |
| 浙江省      | 杭州市  | 拱墅区    | 986.6   |
| 浙江省      | 宁波市  | 鄞州区    | 1018.2  |
| 浙江省      | 宁波市  | 北仑区    | 898.4   |
| 浙江省      | 宁波市  | 慈溪市    | 872.2   |

!!! Abstract ""
    如下示例，生成全国的 GDP 地图后，拖拽钻取字段至【钻取/维度】。

![添加视图](../../img/view_generation/地图钻取设置.png){ width="900px" }

!!! Abstract ""
    第一步，点击【广东省】。

![钻取](../../img/view_generation/下钻.png){ width="900px" }

!!! Abstract ""
    第二步，下钻结果展示，如下图，展示广东省地图。如果想返回上一级，点击视图左下角的【全部】，返回全国地图。

![钻取](../../img/view_generation/下钻返回.png){ width="900px" }

### 1.6 重置

!!! Abstract ""
    如下图所示，点击【重置】，可将本次对于该视图的编辑全部还原。  
    **提示：** 根据用户反馈，有时会误点重置按钮，v1.12.0 版本开始，视图重置增加了确认提示。

![重置](../../img/view_generation/重置.png){ width="900px" }

![重置确认](../../img/view_generation/重置确认.png){ width="900px" }

## 2 数据设置

### 2.1 可选维度列表

!!! Abstract ""
    展示所有可选维度，当选择数据集后，维度与指标由系统自动分配，分配原则：文本型字段默认为维度、数值型字段默认为指标，因此如果需要某个字段作为指标，在数据集中编辑字段，将其设置为维度。

![可选维度列表](../../img/view_generation/可选维度列表.png){ width="900px" }

### 2.2 可选指标列表

!!! Abstract ""
    展示所有可选指标，当选择数据集后，维度与指标由系统自动分配，分配原则：文本型字段默认为维度、数值型字段默认为指标，因此如果需要某个字段作为指标，在数据集中编辑字段，将其设置为指标。

![可选指标列表](../../img/view_generation/可选指标列表.png){ width="900px" }

### 2.3 维度选择

!!! Abstract ""
    **如下图所示，通过拖拉的形式，从"维度可选列表中"拖拉至"维度选择"，图表根据所选择的维度去统计分析数据。**

![选择维度](../../img/view_generation/选择维度.png){ width="900px" }

!!! Abstract ""
    **如下图所示，点击维度上的小箭头，弹出设置窗口，可设置维度排序方式、显示名，日期显示和日期格式；**  
    **提示：** 仅时间类型支持设置日期显示和日期格式。

![维度属性设置](../../img/view_generation/维度属性设置.png){ width="900px" }

!!! Abstract ""
    **支持更改维度显示名称，同时保留该字段原始的字段名称，如下图所示。**

![维度_更改字段名称入口](../../img/view_generation/维度_更改字段名称入口.png){ width="900px" }

!!! Abstract ""
    **支持维度自定义排序，具体操作步骤如下图所示。**  
    **注意：**

    - 数值型的不提供自定义排序；
    - 时间类型不支持自定义排序；
    - 透视表只支持数据列维度；
    - 堆叠类图表只支持类别轴维度。

    Tips：可以根据前面的图标快速判断当前设置的排序方式。


![维度_自定义排序](../../img/view_generation/维度_自定义排序.png){ width="900px" }

![维度_自定义排序调整](../../img/view_generation/维度_自定义排序调整.png){ width="900px" }


### 2.4 指标选择

!!! Abstract ""
    **如下图所示，通过拖拉的形式，从"指标可选列表中"拖拉至"指标选择"，图表根据所选择的指标进一步分析展示数据。**

![选择指标](../../img/view_generation/选择指标.png){ width="900px" }

!!! Abstract ""
    **如下图所示，点击指标上的小箭头，弹出设置窗口，可设置指标汇总方式；**  
    不同字段类型对应的汇总方式不同，具体如下。

    - 数值型支持求和、平均、最大值、最小值、标准差、方差、计数、去重统计；
    - 文本类型支持计数、去重统计；
    - 时间类型支持计数、去重统计。

![指标设置](../../img/view_generation/指标属性设置.png){ width="900px" }

!!! Abstract ""
    **支持更改指标显示名称，同时保留该字段原始的字段名称，如下图所示。**
    
![指标_更改字段名称入口](../../img/view_generation/指标_更改字段名称入口.png){ width="900px" }

!!! Abstract ""
    **支持快速计算（同比环比、占比计算）、支持排序，可设置过滤等；**  
    **注意：使用同比环比功能，需字段为日期类型，若【同比环比】不可点击，请检查维度字段是否为日期类型。**

![同比环比](../../img/view_generation/同比环比.png){ width="900px" }

!!! Abstract ""
    **支持设置数值格式化，AntV 图库图表支持数值格式化（注意除文本卡和符号地图外）。**

    - 支持数量单位：千、万、百万、亿；
    - 支持设置小数位数；
    - 支持设置为百分比格式；
    - 支持设置单位后缀；
    - 支持打开千分位，即每三位数，以逗号隔开的方式，20,000,000。

    下图以 AntV 图库指标卡为例。

![设置数值格式化](../../img/view_generation/设置数值格式化.png){ width="900px" }

![设置数值格式_指标卡展示结果](../../img/view_generation/设置数值格式_指标卡展示结果.png){ width="900px" }

### 2.5 结果过滤器

!!! Abstract ""
    可点击设置过滤条件，对结果进行过滤。

![图表样式](../../img/view_generation/结果过滤器.png){ width="900px" }

!!! Abstract ""
    如下图所示，可设置多个过滤条件，并且支持逻辑条件过滤（或、与），可选择等于、不等于、包含、不包含、为空、不为空，支持字段枚举值过滤。

![图表样式](../../img/view_generation/结果过滤器设置.png){ width="900px" }

## 3 样式设置

!!! Abstract ""
    点击【样式】，切换至样式设计界面，该界面主要针对【图形属性】和【组件样式】进行调整，**不同的视图类型可支持的样式会有所差异，不同的图表库（Echarts、AntV）在样式上也有一些差异。**

![视图可选维度列表](../../img/view_generation/数据样式切换.png){ width="900px" }

### 3.1 图形属性

!!! Abstract ""
    如下图，支持修改图形的颜色，大小，标签等。

![图形属性](../../img/view_generation/图形属性.png){ width="900px" }

!!! Abstract ""
    AntV 图库玫瑰图，饼图，环形图，玫瑰环形图支持标签内容显示，支持通过勾选的方式选择展示的维度、指标、占比。

![图形属性](../../img/view_generation/AntV图库标签内容.png){ width="900px" }

!!! Abstract ""
    支持配置系统方案（默认、复古、淡雅、未来、渐变、简洁、商务、柔和、科技、明亮、经典、清新、活力、火红、轻快、灵动）；  
    如下图，点击，也可以自定义配色。

![图形属性_修改颜色](../../img/view_generation/图形属性_修改颜色.png){ width="900px" }

!!! Abstract ""
    ECharts 图库地图的样式配色方案中支持渐变色选项。

    - 【分离渐变】：系统内置的渐变色方案；
    - 【自定义】：可自定义开始和结束的颜色，系统会自动生成渐变色方案。

![图形属性_渐变色方案](../../img/view_generation/图形属性_渐变色方案.png){ width="900px" }

!!! Abstract ""
    应用配色方案后，仍然可以进一步调整颜色，如下图所示，整个视图应用到的颜色都会在下方列出来，修改时不需要再在配色方案中选中，自行修改颜色后，配色方案中所展示的颜色将不会跟着改变。  
    **注意：** 此项设置目前只支持 AntV 图库视图，且只包含以下列出的视图，ECharts 图库未支持。
    
    - 柱状图：基础柱状图、堆叠柱状图、横向柱状图、堆叠横向柱状图；
    - 折线图：基础折线图、堆叠折线图；
    - 饼图：饼图、玫瑰图；
    - 雷达图；
    - 漏斗图；
    - 散点图；
    
    其中柱状图、折线图、散点图、支持系列设置颜色，其余支持维度枚举值设置颜色，如下图所示。

![图形属性_自定义配色](../../img/view_generation/图形属性_自定义配色.png){ width="900px" }

### 3.2 组件样式

!!! Abstract ""
    支持修改组件的标题（标题名称、字体大小、字体颜色、水平位置、垂直位置、字体样式），图例（图标、方向、字体大小、字体颜色、水平位置、垂直位置）等。

![组件样式](../../img/view_generation/组件样式.png){ width="900px" }

!!! Abstract ""
    AntV 图库标题支持双击修改。

![ AntV 图库标题](../../img/view_generation/AntV图库标题.png){ width="900px" }

!!! Abstract ""
    视图提示支持背景选项。

![组件样式_背景](../../img/view_generation/组件样式_背景.png){ width="900px" }  

!!! Abstract ""
    AntV 图库仪表盘视图支持在组件样式设置最小值、最大值、支持用视图指标来动态设置最大值和最小值，支持刻度间隔数，支持标签设置数值格式。

![组件样式_AntV](../../img/view_generation/组件样式_AntV.png){ width="900px" }

!!! Abstract ""
    水波图目标值支持设置动态值设置，应用示例如下：  
    指标放置了 ”销售价“ 并且计算方式为 “求和”。

![组件样式_AntV](../../img/view_generation/组件样式_AntV1.png){ width="900px" }

!!! Abstract ""
    目标值使用了原始价的求和，则水波图自动计算出了销售价的总数占原始价总数的多少，即整体的折扣率。

![组件样式_AntV](../../img/view_generation/组件样式_AntV2.png){ width="900px" }

!!! Abstract ""
    有坐标轴的视图（柱状图、折线图等），轴值支持数值格式化设置，如下图所示，在样式的纵轴(横向图则为横轴)设置中。

![组件样式_设置格式化](../../img/view_generation/组件样式_数值格式化.png){ width="900px" }

!!! Abstract ""
    AntV 图库图表标题支持备注，同时支持字体、阴影和间距设置；  
    AntV 指标卡、AntV 文本卡，除了标题以外，在样式->大小选项中，对值和名称也支持字体、阴影、间距、粗细设置。

![组件样式_编辑标题备注](../../img/view_generation/组件样式_编辑标题备注.png){ width="900px" }

![组件样式_标题备注](../../img/view_generation/组件样式_标题备注.png){ width="900px" }

![组件样式_标题字体样式](../../img/view_generation/组件样式_标题字体样式.png){ width="900px" }

![组件样式_值与名称字体样式](../../img/view_generation/组件样式_值与名称字体样式.png){ width="900px" }

!!! Abstract ""
    支持 ECharts 视图外边距设置。

    - 自动：系统的默认值，自动适配；
    - 绝对：配置实际距离；
    - 相对：配置相对的百分比。

![ECharts视图外边距](../../img/view_generation/ECharts视图外边距.png){ width="900px" }

![ECharts视图外边距](../../img/view_generation/ECharts视图外边距_实际距离.png){ width="900px" }

![ECharts视图外边距](../../img/view_generation/ECharts视图外边距_百分比.png){ width="900px" }

!!! Abstract ""
    **序号设置：** AntV 明细表和汇总表支持序号设置，同时支持给序号列命名。

![ECharts视图外边距](../../img/view_generation/AntV明细表和汇总表_序号设置.png){ width="900px" }

!!! Abstract ""
    带坐标系的视图类型支持坐标轴轴线显示控制的选项。

![坐标轴轴线显示控制](../../img/view_generation/坐标轴轴线显示控制.png){ width="900px" }

## 4 高级设置

!!! Abstract ""
    视图编辑区【高级】模块，不同视图存在差异，根据各视图特性具备不同的高级功能。

![高级设置](../../img/view_generation/高级设置.png){ width="900" }

### 4.1 缩略轴

!!! Abstract ""
    **柱状图和折线图支持设置缩略轴，可通过调整缩略轴快速调整显示的维度范围；**  
    如下图所示，切换至【高级】，点击功能设置，勾选【显示】缩略轴，调整维度显示范围；  
    缩略轴支持样式配置，支持背景、选中背景、字体颜色三个样式配置项。

![高级设置_缩略轴](../../img/view_generation/高级设置_缩略轴.png){ width="900" }

### 4.2 辅助线

!!! Abstract ""
    **对于具备横纵坐标系的视图（柱状图、折线图）支持设置辅助线；**  

    - 支持设置名称、数值展示，且名称和数值的展示位置跟随坐标轴，当坐标轴分别放置在左右两侧时，辅助线的内容将跟随变化；  
    - 支持设置短划线类型（实线、线型虚线、点型虚线）、短划线颜色；  
    - 支持设置动态值，包括平均值、最大值、最小值；  
    - 支持同一图表设置多条辅助线；  
    如下图所示，切换至【高级】，点击【编辑】辅助线，弹出辅助线设置框，填写预警值名称及其他参数，点击【确定】即可。

![高级设置_辅助线](../../img/view_generation/高级设置_辅助线.png){ width="900px" }

![高级设置_辅助线显示效果](../../img/view_generation/高级设置_辅助线显示效果.png){ width="900px" }

!!! Abstract ""
    辅助线数值格式化支持跟随轴设置。

![高级设置_辅助线跟随轴设置](../../img/view_generation/高级设置_辅助线跟随轴设置.png){ width="900px" }

### 4.3 阈值

!!! Abstract ""
    如下图所示，切换至【高级】，点击【编辑】设置阈值，根据不同的字段类型可选的判断条件不同；  
    以数字类型的判断条件为例：可设置**介于**、等于、不等于、小于、大于、小于等于、大于等于；  
    目前支持的视图有指标卡，仪表盘。此外 AntV 图库的汇总表、明细表、透视表均支持阈值设置，支持配置文字颜色和背景颜色，支持默认背景色调整。

![高级设置_阈值设置](../../img/view_generation/高级设置_阈值设置.png){ width="900px" }  
![高级设置_阈值设置显示](../../img/view_generation/高级设置_阈值设置显示.png){ width="900px" }

!!! Abstract ""
    仪表盘阈值设置如下图所示，切换至【高级】，进入【阈值区间】设置，支持范围（0-100），逐级递增，若为空则不开启阈值，示例输入 30，70，表示分 3 段，分别为[0,30]，(30,70]，(70,100]。

![高级设置_阈值设置仪表盘](../../img/view_generation/高级设置_阈值设置仪表盘.png){ width="900px" }

### 4.4 滚动

!!! Abstract ""
    如下图所示，表格支持滚动设置，支持滚动行数和时间间隔设置；  
    开启滚动后，鼠标在表格的滚动事件仍然有效，无法改变当前自动滚动的位置，即：鼠标触发滚动事件后，下次自动滚动，仍然从上一次自动滚动后的位置开始，不会从鼠标滚轮滚动后的位置开始，比如：目前自动滚动到第三行，下次应该滚动第四行，但在这之间，鼠标滚动了一下到第五行，下次自动滚动仍然为第四行。  
    **注意：** 透视表不支持滚动，明细表需设置分页模式为下拉时滚动才能生效。

![高级设置_表格滚动](../../img/view_generation/高级设置_表格滚动下拉模式.png){ width="900px" }  
![高级设置_表格滚动](../../img/view_generation/高级设置_表格滚动.png){ width="900px" }